# Битрикс24 Интеграция

Трехстраничный сайт с интеграцией Битрикс24 API, построенный на Next.js + TypeScript.

## Функциональность

### Страницы
- **Регистрация/Авторизация** - форма входа с валидацией
- **Дашборд** - главная страница с блоками заказов, профиля, трансляции и платежей
- **Платежи** - управление сделками из Битрикс24

### Технологии
- Next.js 15 + TypeScript
- SCSS для стилизации
- Swiper для слайдеров
- Better-sqlite3 для локальной БД
- Material-UI компоненты
- Битрикс24 API интеграция

## Установка и запуск

1. Установите зависимости:
```bash
npm install
```

2. Настройте Битрикс24:
   - Создайте аккаунт Битрикс24
   - Перейдите в раздел: Приложения → Разработчикам → Другое → Входящий вебхук
   - Включите демо-тариф и получите URL вебхука

3. Создайте файл `.env.local`:
```env
BITRIX_WEBHOOK_URL=your_webhook_url_here
```

4. Запустите проект:
```bash
npm run dev
```

## Структура проекта

```
src/
├── app/
│   ├── api/
│   │   ├── auth/
│   │   │   ├── login/route.ts
│   │   │   └── register/route.ts
│   │   └── deals/
│   │       ├── route.ts
│   │       └── [id]/pay/route.ts
│   ├── dashboard/page.tsx
│   ├── login/page.tsx
│   ├── payments/page.tsx
│   ├── register/page.tsx
│   └── page.tsx
├── components/
│   └── Header.tsx
└── lib/
    ├── bitrix.ts
    ├── database.ts
    └── validation.ts
```

## API Endpoints

### Аутентификация
- `POST /api/auth/register` - регистрация пользователя
- `POST /api/auth/login` - вход в систему

### Сделки
- `GET /api/deals` - получение списка сделок из Битрикс24
- `POST /api/deals/[id]/pay` - обработка платежа

## Особенности

### Валидация
- Пароль: минимум 6 символов, одна заглавная буква, одна цифра
- Email: корректный формат
- Логин: минимум 3 символа, только буквы, цифры и подчеркивания

### База данных
- SQLite с better-sqlite3
- Хеширование паролей с bcrypt
- Связь с контактами Битрикс24

### Битрикс24 интеграция
- Создание контактов при регистрации
- Получение списка сделок
- Обновление статуса сделок при оплате

## Развертывание

1. Соберите проект:
```bash
npm run build
```

2. Запустите продакшн версию:
```bash
npm start
```

## Требования

- Node.js 18+
- Аккаунт Битрикс24 с демо-тарифом
- Webhook URL от Битрикс24